








<div class='container-fluid mt-5'>

   <div>
        <h6><strong>Image Library </strong></h6>
        <br>
        <form>
            <div class="row">
                <div class="col-md-5 mb-3 ">
                    <label class="sr-only" for="inlineFormInputGroupUsername2"></label>
                    <div class="input-group">
                        <input class="form-control custom-input float-left  rounded-pill  searchbox"
                            placeholder="search" id="pageImageLibrary_search">
                        <button class="btn rounded-pill border-0 ml-n5 bg-transparent" type="button">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>
                </div>
                <div class="col-md-4">
                </div>
                <div class="col-md-3">
                    <div class="input-group">
                        <button type="button"
                            class="btn btn-primary  form-control custom-input float-right rounded-pill border-0 callpageRole" onclick="change_content('pageRole')"
                            ><i id="pageImageLibrary_create"  name="pageImageLibrary_create"></i> Add Image</button>
                    </div>
                </div>
            </div>
        </form>
        <br>
    </div>
       
<div id="imglibTableID" class="mt-2 w-100">
   
</div>
    <!-- Footer-->
</div>


<script>
$(document).ready(function() {
   loadImageLibrary();
//   imglibDataTables();          
} );    
</script>

<script>
function loadImageLibrary() {
var _params = {"action": "get_imagelibrary"};
google.script.run
.withFailureHandler(loadImageLibraryError)
.withSuccessHandler(loadImageLibraryOk)
.executeimagelibrary(_params);
}

function loadImageLibraryError(err) {
  //error
}
function loadImageLibraryOk(response) {
  if (response.result.code == 3000) {      
     var recLen = Object.keys(response.data.imagelibrary[0]).length;
     var recData = [];
      for(i=0;i<recLen;i++){
         var _jsonkey = (Object.getOwnPropertyNames(response.data.imagelibrary[0]))[i];
         recData.push({ "id": _jsonkey,
                       "imagetype":  response.data.imagelibrary[0][_jsonkey].imagetype,
                       "url":  response.data.imagelibrary[0][_jsonkey].url,
                       "keyword":  response.data.imagelibrary[0][_jsonkey].keyword,
                       "status":  response.data.imagelibrary[0][_jsonkey].status,
                       "filename":  response.data.imagelibrary[0][_jsonkey].filename                      
                      });        
      }  
      imglibFillData(recData);
    } else {
     // no record;
    }
}
</script>

<script>
//function imglibDataTables(){
//   var elemID = "imglibTable";  
//   var table =  $("#" + elemID).DataTable( {
//         dom: 'rtip',
//         "ordering": false,  
//         "initComplete": function(settings, json) {
//                         var elemID = "imglibTable";  
//                         document.getElementById(elemID + "_previous").classList.add("customDataTables_pagePrev");
//                         document.getElementById(elemID + "_next").classList.add("customDataTables_pageNext");
//                           
//                         }, //initComplete
//          "drawCallback": function( settings ) {
//                         var elemID = "imglibTable";  
//                         document.getElementById(elemID + "_previous").classList.add("customDataTables_pagePrev");
//                         document.getElementById(elemID + "_next").classList.add("customDataTables_pageNext");
//                           }
//        });     
//    //Custom Search Button
//    $('#pageImageLibrary_search').on( 'keyup', function () {table.search( this.value ).draw();});  
//}
</script>

<script>
function imglibFillData(data){    
var txt_Header =
"        <div class='table-responsive-xl'><table id=\"imglibTable\" class=\"table table-borderless  bg-white rounded\" style=\"padding-left:50px;padding-right:50px;\">" +
" <thead >" +
" <tr>" +
" <th>Filename</th>" +
" <th>Image</th>" +
" <th>Type</th>" +
" <th>Keyword</th>" +
" <th>Active</th>" +
" <th>Details</th>" +
" </tr>" +
" </thead>" +
" <tbody>" ;

var txt_Footer =
" </tbody>" +
" <tfoot>" +
" </tfoot>" +
" </table></div>" ;


  var txt_all='';
  var txt_hrd='';
  var col=[];
 
      var dataRec = data;
      if (dataRec !== null){
      txt_hrd='';
      for(j=0;j<dataRec.length;j++){
        col[0] = '<td>' + dataRec[j]["filename"] + '</td>';        
        col[1] = '<td><img src="' + dataRec[j]["url"] + '" style="width: 30px; height: 30px"></td>';        
        col[2] = '<td>' + dataRec[j]["imagetype"] + '</td>';
        col[3] = '<td>' + dataRec[j]["keyword"] + '</td>';

        if(dataRec[j]["status"] == 'true'){
         col[4] = '<td><div class="custom-control custom-switch">' +
         '<input type="checkbox" class="custom-control-input active changedownload" id="isActive_1" name="isActive_1" checked>' +
         '<label class="custom-control-label" for="isActive_1"></label>' +
         '</div></td>' ;
        } else {
         col[4] = '<td><div class="custom-control custom-switch">' +
         '<input type="checkbox" class="custom-control-input active changedownload" id="isActive_1" name="isActive_1">' +
         '<label class="custom-control-label" for="isActive_1"></label>' +
         '</div></td>' ;
        }    
        col[5] = '<td><div onclick="alert(' +  dataRec[j]["id"] + ')"><svg class="svg-inline--fa fa-eye fa-w-18" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="eye" role="img" xmlns=    "http://www.w3.org/2000/svg" viewBox="0 0 576 512" data-fa-i2svg=""><path fill="currentColor" d="M572.52 241.4C518.29 135.59 410.93 64 288 64S57.68 135.64 3.48 241.41a32.35 32.35 0 0 0 0 29.19C57.71 376.41 165.07 448 288 448s230.32-71.64 284.52-177.41a32.35 32.35 0 0 0 0-29.19zM288 400a144 144 0 1 1 144-144 143.93 143.93 0 0 1-144 144zm0-240a95.31 95.31 0 0 0-25.31 3.79 47.85 47.85 0 0 1-66.9 66.9A95.78 95.78 0 1 0 288 160z"></path></svg></div></td>';
       
       
        txt_all += '<tr>' + col[0] + col[1] + col[2] + col[3]+ col[4]+ col[5]+ '</tr>';
      }
      }

document.getElementById("imglibTableID").innerHTML = txt_Header + txt_all + txt_Footer;
 
 //Initialize datatables;
 var elemID = "imglibTable";  
   var imagetable =  $("#" + elemID).DataTable( {
         dom: 'rtip',
         "ordering": false,  
         "initComplete": function(settings, json) {
                         var elemID = "imglibTable";  
                         document.getElementById(elemID + "_previous").classList.add("customDataTables_pagePrev");
                         document.getElementById(elemID + "_next").classList.add("customDataTables_pageNext");
                           
                         }, //initComplete
          "drawCallback": function( settings ) {
                         var elemID = "imglibTable";  
                         document.getElementById(elemID + "_previous").classList.add("customDataTables_pagePrev");
                         document.getElementById(elemID + "_next").classList.add("customDataTables_pageNext");
                           }
        });    
    //Custom Search Button
    $('#pageImageLibrary_search').on( 'keyup', function () {imagetable.search( this.value ).draw();});  
   

}
</script>